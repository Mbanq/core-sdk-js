"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _chunkE4GWSVC5js = require('./chunk-E4GWSVC5.js');var u=r=>{let t=[];if(!r.baseUrl)t.push("baseUrl is required");else if(typeof r.baseUrl!="string")t.push("baseUrl must be a string");else try{new URL(r.baseUrl)}catch (e2){t.push("baseUrl must be a valid URL")}return _optionalChain([r, 'access', _ => _.axiosConfig, 'optionalAccess', _2 => _2.timeout])!==void 0&&(typeof r.axiosConfig.timeout!="number"||r.axiosConfig.timeout<0)&&t.push("timeout must be a positive number"),t};var C=r=>{let t=u(r);if(t.length>0)throw _chunkE4GWSVC5js.a.call(void 0, {message:`Invalid configuration: ${t.join(", ")}`,code:"invalid_config"});let n=async(e,o,s)=>{if(r.middlewares)for(let a of r.middlewares)e==="before"&&a.before?await a.before(o):e==="after"&&a.after?await a.after(o,s):e==="onError"&&a.onError&&await a.onError(o,s)},i={...r};return{setConfig:e=>{i=e},updateConfig:e=>{let o={...i,...e,axiosConfig:{...i.axiosConfig,...e.axiosConfig,headers:{..._optionalChain([i, 'access', _3 => _3.axiosConfig, 'optionalAccess', _4 => _4.headers]),..._optionalChain([e, 'access', _5 => _5.axiosConfig, 'optionalAccess', _6 => _6.headers])}}},s=u(o);if(s.length>0)throw _chunkE4GWSVC5js.a.call(void 0, {message:`Invalid configuration: ${s.join(", ")}`,code:"invalid_config"});i=o},resetConfig:()=>{i=r},request:async e=>{try{await n("before",e);let o=await e.execute(i);return await n("after",e,o),o}catch(o){throw await n("onError",e,o),o}}}};exports.a = C;
