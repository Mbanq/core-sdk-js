"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _chunkOGW7GTJPjs = require('./chunk-OGW7GTJP.js');var E=t=>{let n=[];if(!t.baseUrl)n.push("baseUrl is required");else if(typeof t.baseUrl!="string")n.push("baseUrl must be a string");else try{new URL(t.baseUrl)}catch (e2){n.push("baseUrl must be a valid URL")}return _optionalChain([t, 'access', _2 => _2.axiosConfig, 'optionalAccess', _3 => _3.timeout])!==void 0&&(typeof t.axiosConfig.timeout!="number"||t.axiosConfig.timeout<0)&&n.push("timeout must be a positive number"),n};var _zod = require('zod');var N=_zod.z.enum(["originatorName","originatorAccount","originatorBankRoutingCode","recipientName","recipientAccount","recipientBankRoutingCode","reference","traceNumber","externalId","clientId","dateFormat","locale","originatedBy","paymentRail","paymentType","fromValueDate","toValueDate","fromExecuteDate","toExecuteDate","status","fromReturnDate","toReturnDate","isSettlement","orderBy","sortOrder"]),h= exports.b =_zod.z.enum(["DRAFT","AML_SCREENING","AML_REJECTED","EXECUTION_SCHEDULED","EXECUTION_PROCESSING","EXECUTION_SUCCESS","EXECUTION_FAILURE","RETURNED","CANCELLED","COMPLIANCE_FAILURE","DELETED","UNKNOWN"]),P= exports.c =_zod.z.enum(["ACH","SAMEDAYACH","WIRE","SWIFT","INTERNAL","FXPAY","CARD"]),C= exports.d =_zod.z.enum(["CREDIT","DEBIT"]),w= exports.e =_zod.z.enum(["ASC","DESC"]),ze=N.options,Ve=h.options,je=P.options,Me=C.options,$e=w.options,B=t=>N.parse(t),F=t=>h.parse(t),k=t=>P.parse(t),U=t=>C.parse(t),L=t=>w.parse(t),_=_zod.z.string().min(1),z=_zod.z.string().min(1),V=_zod.z.string().min(1),j=_zod.z.string().min(1),M=_zod.z.string().min(1),$=_zod.z.string().min(1),G=_zod.z.string().min(1),K=_zod.z.string().min(1),q=_zod.z.string().min(1),H=_zod.z.union([_zod.z.string(),_zod.z.number()]),Y=_zod.z.string(),W=_zod.z.string(),X=_zod.z.string(),O=_zod.z.string(),T=_zod.z.string(),A=_zod.z.string(),J=_zod.z.boolean(),Q=_zod.z.string(),Z=t=>_.parse(t),ee=t=>z.parse(t),te=t=>V.parse(t),ne=t=>j.parse(t),ae=t=>M.parse(t),re=t=>$.parse(t),oe=t=>G.parse(t),ie=t=>K.parse(t),se=t=>q.parse(t),ce=t=>H.parse(t),pe=t=>Y.parse(t),me=t=>W.parse(t),de=t=>X.parse(t),ye=t=>O.parse(t),le=t=>T.parse(t),ue=t=>A.parse(t),ge=t=>J.parse(t),fe=t=>Q.parse(t),Oe= exports.f ={originatorName:_.optional(),originatorAccount:z.optional(),originatorBankRoutingCode:V.optional(),recipientName:j.optional(),recipientAccount:M.optional(),recipientBankRoutingCode:$.optional(),reference:G.optional(),traceNumber:K.optional(),externalId:q.optional(),clientId:H.optional(),dateFormat:Y.optional(),locale:W.optional(),originatedBy:X.optional(),paymentRail:P.optional(),paymentType:C.optional(),fromValueDate:O.optional(),toValueDate:O.optional(),fromExecuteDate:T.optional(),toExecuteDate:T.optional(),status:h.optional(),fromReturnDate:A.optional(),toReturnDate:A.optional(),isSettlement:J.optional(),orderBy:Q.optional(),sortOrder:w.optional(),limit:_zod.z.number().positive().optional().describe("Max number of records to return. Defaults to 20 if not provided. To fetch all records, set to 0."),offset:_zod.z.number().min(0).optional()},Ge= exports.g =_zod.z.object(Oe).partial();var Te={id:_zod.z.number(),clientId:_zod.z.number(),amount:_zod.z.number().positive(),correlationId:_zod.z.string(),paymentType:C,paymentRail:P,recipient:_zod.z.object({cardId:_zod.z.string().optional(),recipientType:_zod.z.string(),address:_zod.z.object({line1:_zod.z.string().optional(),line2:_zod.z.string().optional(),stateCode:_zod.z.string().optional(),countryCode:_zod.z.string(),postalCode:_zod.z.string().optional()}),name:_zod.z.string()}),originator:_zod.z.object({accountId:_zod.z.string().optional(),recipientType:_zod.z.string(),address:_zod.z.object({line1:_zod.z.string().optional(),line2:_zod.z.string().optional(),stateCode:_zod.z.string().optional(),countryCode:_zod.z.string(),postalCode:_zod.z.string().optional()}),name:_zod.z.string()}),executedAt:_zod.z.string(),createdAt:_zod.z.string(),externalId:_zod.z.string(),status:h,paymentRailMetaData:_zod.z.record(_zod.z.string(),_zod.z.any()).optional(),currencyData:_zod.z.object({code:_zod.z.string(),name:_zod.z.string(),decimalPlaces:_zod.z.number(),displaySymbol:_zod.z.string(),nameCode:_zod.z.string(),currencyCodeInDigit:_zod.z.number(),isBaseCurrency:_zod.z.boolean()}),currency:_zod.z.string().min(3).max(3)},xe=_zod.z.object(Te).catchall(_zod.z.any()),Ie=_zod.z.object({streetAddress:_zod.z.string().optional(),city:_zod.z.string().optional(),state:_zod.z.string().optional(),country:_zod.z.string().optional(),postalCode:_zod.z.string().optional()}).optional(),Ae=_zod.z.object({name:_zod.z.string().optional(),identifier:_zod.z.string().optional(),address:Ie}).optional(),v=_zod.z.object({name:_zod.z.string(),identifier:_zod.z.string(),accountType:_zod.z.enum(["CHECKING","SAVINGS"]).optional(),address:Ie,agent:Ae}),we= exports.i ={amount:_zod.z.number().positive(),currency:_zod.z.string().min(3).max(3),paymentRail:P,paymentType:C,debtor:v,creditor:v,clientId:_zod.z.string().optional(),correspondent:v.optional(),exchangeRate:_zod.z.number().positive().optional(),externalId:_zod.z.string().optional(),reference:_zod.z.union([_zod.z.string(),_zod.z.array(_zod.z.string())]).optional(),paymentRailMetaData:_zod.z.record(_zod.z.string(),_zod.z.any()).optional(),chargeBearer:_zod.z.enum(["OUR","BEN","SHA"]).optional(),purposeCode:_zod.z.string().optional(),valueDate:_zod.z.string().optional(),executionDate:_zod.z.string().optional()},Ne= exports.j =_zod.z.object(we).catchall(_zod.z.any()).refine(t=>(t.paymentRail==="WIRE"||t.paymentRail==="SWIFT")&&t.creditor?t.creditor.address&&t.creditor.address.state&&t.creditor.address.country:!0,{message:"For WIRE transfers, recipient address with state and country is mandatory"}),Be= exports.k ={amount:_zod.z.number().positive().optional(),correspondent:_zod.z.object({name:_zod.z.string().optional(),identifier:_zod.z.string().optional(),accountType:_zod.z.string().optional()}).optional(),creditor:_zod.z.object({name:_zod.z.string().optional(),identifier:_zod.z.string().optional(),accountType:_zod.z.string().optional(),agent:_zod.z.object({name:_zod.z.string().optional(),identifier:_zod.z.string().optional()}).optional()}).optional(),debtor:_zod.z.object({name:_zod.z.string().optional(),identifier:_zod.z.string().optional(),accountType:_zod.z.string().optional(),agent:_zod.z.object({name:_zod.z.string().optional(),identifier:_zod.z.string().optional()}).optional()}).optional(),exchangeRate:_zod.z.number().positive().optional(),externalId:_zod.z.string().optional(),errorCode:_zod.z.string().optional(),errorMessage:_zod.z.string().optional(),reference:_zod.z.union([_zod.z.string(),_zod.z.array(_zod.z.string())]).optional(),paymentRailMetaData:_zod.z.record(_zod.z.string(),_zod.z.any()).optional(),status:h.optional()},Fe= exports.l =_zod.z.object(Be).catchall(_zod.z.any()),Ke= exports.m =_zod.z.object({totalFilteredRecords:_zod.z.number(),pageItems:_zod.z.array(xe)}),S=t=>xe.parse(t),he=t=>Ne.parse(t),Pe=t=>Fe.parse(t);var qe=_zod.z.object({id:_zod.z.string(),clientId:_zod.z.number(),resourceId:_zod.z.number(),resourceIdentifier:_zod.z.string()});var ke=t=>{try{B(t)}catch(n){throw n instanceof _zod.ZodError?_chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid filter key: '${t}'. ${n.message}`,code:"invalid_filter_key"}):n}},Ue=(t,n)=>{try{switch(t){case"status":F(n);break;case"paymentRail":k(n);break;case"paymentType":U(n);break;case"sortOrder":L(n);break;case"originatorName":Z(n);break;case"originatorAccount":ee(n);break;case"originatorBankRoutingCode":te(n);break;case"recipientName":ne(n);break;case"recipientAccount":ae(n);break;case"recipientBankRoutingCode":re(n);break;case"reference":oe(n);break;case"traceNumber":ie(n);break;case"externalId":se(n);break;case"clientId":ce(n);break;case"dateFormat":pe(n);break;case"locale":me(n);break;case"originatedBy":de(n);break;case"fromValueDate":case"toValueDate":ye(n);break;case"fromExecuteDate":case"toExecuteDate":le(n);break;case"fromReturnDate":case"toReturnDate":ue(n);break;case"isSettlement":ge(n);break;case"orderBy":fe(n);break;default:break}}catch(r){throw r instanceof _zod.ZodError?_chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid value for '${t}': '${n}'. ${r.message}`,code:`invalid_${t}_value`}):r}},Ce= exports.n =t=>({input:t,metadata:{commandName:"CreatePayment",path:"/v1/payments",method:"POST"},execute:async n=>{try{he(t.payment)}catch(a){throw a instanceof _zod.ZodError?_chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid payment data: ${a.message}`,code:"invalid_payment_input"}):a}t.tenantId&&(n.tenantId=t.tenantId);let r=await _chunkOGW7GTJPjs.d.call(void 0, n);try{let a=await r.post("/v1/payments",t.payment);return S(a.data)}catch(a){_chunkOGW7GTJPjs.c.call(void 0, a)}}}),Re= exports.o =t=>({input:t,metadata:{commandName:"GetPayment",path:`/v1/payments/${t.id}`,method:"GET"},execute:async n=>{t.tenantId&&(n.tenantId=t.tenantId);let r=await _chunkOGW7GTJPjs.d.call(void 0, n);try{let a=await r.get(`/v1/payments/${t.id}`);return S(a.data)}catch(a){_chunkOGW7GTJPjs.c.call(void 0, a)}}}),Se= exports.p =t=>({input:t,metadata:{commandName:"UpdatePayment",path:`/v1/payments/${t.id}`,method:"PUT"},execute:async n=>{try{Pe(t.payment)}catch(a){throw a instanceof _zod.ZodError?_chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid payment update data: ${a.message}`,code:"invalid_payment_update_input"}):a}t.tenantId&&(n.tenantId=t.tenantId);let r=await _chunkOGW7GTJPjs.d.call(void 0, n);try{let a=await r.put(`/v1/payments/${t.id}`,t.payment);return S(a.data)}catch(a){_chunkOGW7GTJPjs.c.call(void 0, a)}}}),R=(t,n,r,a)=>{if(n!==void 0&&n!==0&&n<=0)throw _chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid limit: ${n}. Limit must be positive or 0 for fetching all records.`,code:"invalid_limit"});if(r!==void 0&&r<0)throw _chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid offset: ${r}. Offset must be non-negative.`,code:"invalid_offset"});return{where:p=>(ke(p),{eq:o=>(Ue(p,o),R({...t,[p]:o},n,r,a))}),limit:p=>R(t,p,r,a),offset:p=>R(t,n,p,a),all:()=>R(t,0,r,a),execute:()=>{let p={locale:"en",originatedBy:"us",orderBy:"id",sortOrder:"DESC"},o={...p,...t,limit:n||200,offset:r||0};return{input:{filters:t,limit:n,offset:r,tenantId:a},metadata:{commandName:"ListPayments",path:"/v1/payments",method:"GET"},execute:async s=>{a&&(s.tenantId=a);let c=await _chunkOGW7GTJPjs.d.call(void 0, s);try{if(n===0){let i=[],y=r||0,d=0;do{let g={...p,...t,limit:200,offset:y},D=await c.get("/v1/payments",{params:g}),{totalFilteredRecords:Ee,pageItems:ve}=D.data;i.push(...ve),d=Ee,y+=200}while(y<d);return{totalFilteredRecords:d,pageItems:i}}else return(await c.get("/v1/payments",{params:o})).data}catch(i){_chunkOGW7GTJPjs.c.call(void 0, i)}}}}}},be=t=>({list:()=>R({},void 0,void 0,_optionalChain([t, 'optionalAccess', _4 => _4.tenantId]))}),Qe= exports.q =(t,n)=>({input:{params:t,configuration:n},metadata:{commandName:"GetPayments",path:"/v1/payments",method:"GET"},execute:async r=>{n.tenantId&&(r.tenantId=n.tenantId);let a=await _chunkOGW7GTJPjs.d.call(void 0, r),l=[],I=t.limit||20,p=t.offset||0,o=0,i={...{locale:"en",originatedBy:"us",orderBy:"id",sortOrder:"DESC"},...(m=>{let d=["fromValueDate","toValueDate","fromExecuteDate","toExecuteDate","fromReturnDate","toReturnDate"].some(D=>m[D]!==void 0),g={...m};return d&&g.dateFormat===void 0&&(g.dateFormat="yyyy-MM-dd"),g})(t),limit:I,offset:p};try{if(t.limit===0){do{let m=await a.get("/v1/payments",{params:i}),{totalFilteredRecords:y,pageItems:d}=m.data;l.push(...d),o=y,p+=I}while(p<o);return{totalFilteredRecords:o,pageItems:l}}else return(await a.get("/v1/payments",{params:i})).data}catch(m){_chunkOGW7GTJPjs.c.call(void 0, m)}}}),De=t=>({input:t,metadata:{commandName:"DeletePayment",path:`/v1/payments/${t.id}`,method:"DELETE"},execute:async n=>{t.tenantId&&(n.tenantId=t.tenantId);let r=await _chunkOGW7GTJPjs.d.call(void 0, n);try{await r.delete(`/v1/payments/${t.id}`)}catch(a){_chunkOGW7GTJPjs.c.call(void 0, a)}}});var at=t=>{let n=E(t);if(n.length>0)throw _chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid configuration: ${n.join(", ")}`,code:"invalid_config"});let r=async(o,s,c)=>{if(t.middlewares)for(let i of t.middlewares)o==="before"&&i.before?await i.before(s):o==="after"&&i.after?await i.after(s,c):o==="onError"&&i.onError&&await i.onError(s,c)},a={...t},l=async o=>{try{await r("before",o);let s=await o.execute(a);return await r("after",o,s),s}catch(s){throw await r("onError",o,s),s}},I=o=>{let s=o||a.tenantId;return{payment:{create:c=>{let i=Ce({payment:c,tenantId:s});return{execute:async()=>l(i)}},get:c=>{let i=Re({id:c,tenantId:s});return{execute:async()=>l(i)}},update:(c,i)=>{let m=Se({id:c,payment:i,tenantId:s});return{execute:async()=>l(m)}},delete:c=>{let i=De({id:c,tenantId:s});return{execute:async()=>l(i)}},list:()=>{let i=be({tenantId:s}).list(),m=y=>({where:y.where,limit:d=>{let g=y.limit(d);return m(g)},offset:d=>{let g=y.offset(d);return m(g)},all:()=>{let d=y.all();return m(d)},execute:async()=>{let d=y.execute();return l(d)}});return m(i)}}}};return{setConfig:o=>{a=o},updateConfig:o=>{let s={...a,...o,axiosConfig:{...a.axiosConfig,...o.axiosConfig,headers:{..._optionalChain([a, 'access', _5 => _5.axiosConfig, 'optionalAccess', _6 => _6.headers]),..._optionalChain([o, 'access', _7 => _7.axiosConfig, 'optionalAccess', _8 => _8.headers])}}},c=E(s);if(c.length>0)throw _chunkOGW7GTJPjs.a.call(void 0, {message:`Invalid configuration: ${c.join(", ")}`,code:"invalid_config"});a=s},resetConfig:()=>{a=t},request:l,tenant:o=>I(o),...I()}};exports.a = N; exports.b = h; exports.c = P; exports.d = C; exports.e = w; exports.f = Oe; exports.g = Ge; exports.h = Te; exports.i = we; exports.j = Ne; exports.k = Be; exports.l = Fe; exports.m = Ke; exports.n = Ce; exports.o = Re; exports.p = Se; exports.q = Qe; exports.r = at;
